<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.4/dist/mindar-image.prod.js"></script>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/hiukim/mind-ar-js@1.1.4/dist/mindar-image-aframe.prod.js"></script>
  <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>
</head>

<a-assets>
  <a-asset-item id="model" src="./assets/avocado.glb"></a-asset-item>
</a-assets>

<body>
  <a-scene mindar-image="imageTargetSrc: ./targets.mind; maxTrack: 2">
    <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

    <a-entity mindar-image-target="targetIndex: 0">
      <a-plane color="blue" opacity="0.5" position="0 0 0" height="0.552" width="1" rotation="0 0 0"></a-plane>
    </a-entity>

    <a-entity mindar-image-target="targetIndex: 1" id="target-1">
      <a-entity id="model-entity" gltf-model="#model" rotation="0 180 0" scale="3 3 3" position="0 -0.5 0" animation-mixer="clip: Run"></a-entity>
    </a-entity>

    <div id="question-container" style="display: none;">
      <h1>Question 1</h1>
      <p>Whatâ€™s full of holes but still holds water?</p>
      <input type="radio" name="question1" value="a" /> a. a sponge<br />
      <input type="radio" name="question1" value="b" /> b. a sieve<br />
      <input type="radio" name="question1" value="c" /> c. a colander<br />
      <input type="radio" name="question1" value="d" /> d. a strainer<br />
      <button onclick="checkAnswer(1)">Submit</button>
    </div>

    <div id="redeem-container" style="display: none;">
      <h1>Congratulations!</h1>
      <p>You have answered all the questions correctly.</p>
      <p>Here is your redeem coupon:</p>
      <img src="./redeemCode/redeem.png" alt="Redeem Coupon QR Code" />
    </div>

    <button id="question-button" style="display: none;" onclick="showQuestion()">Press to Show Question</button> <!-- Button to show the question -->

  </a-scene>

  <script>
    var currentQuestion = 1;

    function showQuestion() {
      // Hide the model entity
      document.getElementById("model-entity").setAttribute("visible", false);

      // Show the question container
      document.getElementById("question-container").style.display = "block";
    }

    function checkAnswer(questionNumber) {
      // Get the user's answer from the input field
      var answer = document.querySelector('input[name="question' + questionNumber + '"]:checked');

      // Check if an answer is selected
      if (answer) {
        // Check if the answer is correct
        if (answer.value === "b") {  // Assuming option 'b' is the correct answer for all questions
          // Hide the current question container
          document.getElementById("question-container").style.display = "none";

          // Check if it was the last question
          if (questionNumber === 5) {
            // Show the redeem container
            document.getElementById("redeem-container").style.display = "block";
          } else {
            // Show the next question container
            currentQuestion++;
            document.getElementById("question-container").style.display = "block";
          }
        } else {
          alert("Sorry, that is incorrect. Please try again.");
        }
      } else {
        alert("Please select an answer.");
      }
    }

    // Event listener for touchstart on target with index 1
    document.getElementById("target-1").addEventListener("touchstart", function() {
      document.getElementById("question-button").style.display = "block";
    });
  </script>
</body>
</html>